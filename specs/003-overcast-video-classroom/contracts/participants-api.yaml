openapi: 3.0.3
info:
  title: Overcast Participants API
  description: API for instructor actions on participants (mute, etc.)
  version: 1.0.0
  contact:
    name: Overcast API

servers:
  - url: http://localhost:3000/api
    description: Local development
  - url: https://overcast.vercel.app/api
    description: Production (Vercel)

paths:
  /participants/{sessionId}/mute:
    post:
      summary: Mute or unmute a participant
      description: |
        Allows an instructor to mute a participant's audio.
        WHY: Instructors need classroom management controls (FR-009).
        
        **Important**: Participants can unmute themselves after being muted (FR-019).
        This is a "request to mute" rather than forced mute.
        
        **Functional Requirements**: FR-009, FR-012, FR-019
      operationId: muteParticipant
      tags:
        - Participants
      parameters:
        - name: sessionId
          in: path
          required: true
          description: Daily.co session ID of participant to mute
          schema:
            type: string
          example: abc123session
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MuteParticipantRequest'
            examples:
              mute:
                summary: Mute a participant
                value:
                  muted: true
                  instructorSessionId: xyz789instructor
              unmute:
                summary: Unmute a participant
                value:
                  muted: false
                  instructorSessionId: xyz789instructor
      responses:
        '200':
          description: Mute action succeeded
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/MuteParticipantResponse'
              examples:
                success:
                  value:
                    success: true
                    message: Participant muted successfully
        '403':
          description: User is not an instructor
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                notInstructor:
                  value:
                    success: false
                    error: Only instructors can mute participants
                    code: INSUFFICIENT_PERMISSIONS
        '404':
          description: Participant not found
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'
              examples:
                notFound:
                  value:
                    success: false
                    error: Participant not found in classroom
                    code: PARTICIPANT_NOT_FOUND
        '500':
          description: Server error
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

components:
  schemas:
    MuteParticipantRequest:
      type: object
      required:
        - muted
        - instructorSessionId
      properties:
        muted:
          type: boolean
          description: |
            Whether to mute (true) or unmute (false) the participant.
            WHY: Boolean makes intent clear, unlike separate endpoints.
          example: true
        instructorSessionId:
          type: string
          description: |
            Session ID of instructor making the request.
            WHY: Used to verify instructor role before allowing action.
          example: xyz789instructor

    MuteParticipantResponse:
      type: object
      required:
        - success
      properties:
        success:
          type: boolean
          description: Whether the mute action succeeded
          example: true
        message:
          type: string
          description: Optional human-readable success message
          example: Participant muted successfully

    ErrorResponse:
      type: object
      required:
        - success
        - error
      properties:
        success:
          type: boolean
          description: Always false for errors
          example: false
        error:
          type: string
          description: Human-readable error message
          example: Only instructors can mute participants
        code:
          type: string
          description: Machine-readable error code
          enum:
            - INSUFFICIENT_PERMISSIONS
            - PARTICIPANT_NOT_FOUND
            - INVALID_SESSION_ID
            - SERVER_ERROR
          example: INSUFFICIENT_PERMISSIONS
        details:
          type: object
          description: Additional error context
          additionalProperties: true

tags:
  - name: Participants
    description: Participant management endpoints (instructor actions)

